# Cloud Data Loss Prevention (DLP)

Fully managed service designed to help you _discover, classify, and protect your most sensitive data._\
Reduce data risk with _de-identification methods like redaction, masking, tokenization (pseudonymization - obfuscating the raw sensitive identifiers), bucketing_\
**Data discovery and classification:**

- With over 150 built-in [infoTypes](https://cloud.google.com/dlp/docs/concepts-infotypes) (for times when a dataset hasn't been characterized, Cloud DLP can also inspect the data for sensitive information), Cloud DLP gives you the power to scan, discover, classify, and report on data from virtually anywhere. Cloud DLP has native support for scanning and classifying sensitive data in Cloud Storage, BigQuery, and Datastore and a streaming content API to enable support for additional data sources, custom workloads, and applications.

**Two main types of transformations performed by Cloud DLP**, but both methods can de-identify and encrypt sensitive information in your data. For example, you can transform the values in the US_SOCIAL_SECURITY_NUMBER column to be unidentifiable or use tokenization to obscure it while keeping referential integrity.

- recordTransformations
  - Enables you to apply a transformation configuration per field when using **structured or tabular data**. With the recordTransformations method, you can apply the same transformation across every value in that field such as hashing or tokenizing every value in a column with SSN column as the field or header name.
- infoTypeTransformations
  - Enables you to inspect for sensitive data and transform the finding. For example, if you have **unstructured or free-text data**, the infoTypeTransformations method can help you identify a SSN inside of a sentence and encrypt the SSN value while leaving the rest of the text intact. You can also define custom infoTypes methods.

**De-identification transformations:** [How to best select?](https://cloud.google.com/architecture/de-identification-re-identification-pii-using-cloud-dlp#method_selection)

- Two-way tokenization: Replaces the original data with a token that is deterministic, preserving referential integrity. You can use the token to join data or use the token in aggregate analysis. You can reverse or de-tokenize the data using the same key that you used to create the token. There are two methods for two-way tokenizations:
  - _Deterministic encryption (DE)_: Replaces the original data with a base64-encoded encrypted value and doesn't preserve the original character set or length.
  - _Format-preserving encryption with FFX (FPE-FFX)_: Replaces the original data with a token generated by using format-preserving encryption in FFX mode. By design, FPE-FFX preserves the length and character set of the input text. It lacks authentication and an initialization vector, which can cause a length expansion in the output token. Other methods, like DE, provide stronger security guarantees and are recommended for tokenization use cases unless length and character-set preservation are strict requirements, such as backward compatibility with legacy data systems.
- One-way tokenization, using _cryptographic hashing_: Replaces the original value with a hashed value, preserving referential integrity. However, unlike two-way tokenization, a one-way method **isn't reversible**. The hash value is generated by using an SHA-256-based message authentication code (HMAC-SHA-256) on the input value.
- _Masking_: Replaces the original data with a specified character, either partially or completely.
- _Bucketing_: Replaces a more identifiable value with a less distinguishing value.
- _Replacement_: Replaces original data with a token or the name of the infoType if detected.

**Token encryption keys**

- For cryptographic de-identification transformations, a cryptographic key, also known as token encryption key, is required. The token encryption key that is used for de-identification encryption is also used to re-identify the original value.
  - Use Cloud KMS to create a [wrapped key](https://cloud.google.com/kms/docs/key-wrapping).
